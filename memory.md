## JS中的内存管理
### 前言
---
对于javascript来说，会在创建变量的时候分配内存，并且在这些变量不在被使用的时候“自动”释放内存，这个释放内存的过程叫做垃圾回收。由于垃圾回收机制的存在，让大多javascript开发者认为自己不需要去关心内存管理，所以在一些情况下存在内存泄露的风险。
## 内存的生命周期
---
![](https://user-gold-cdn.xitu.io/2019/6/17/16b63731d983e959?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)

### 垃圾回收
### 引用计数垃圾回收
引用计数垃圾回收的原理很简单，就是找出那些不再被引用的值，然后释放其占用的内存。
引用计数垃圾回收最大的难点是找出那些值不再被引用
>
引用计数的垃圾回收算法简单有效，但是却存在一个致命的缺陷 -- __循环引用__，
循环引用的两个值，不会被引用计数的垃圾回收机制进行回收，从而导致内存泄露。
来看一个循环引用的例子：
```js
function foo() {
  var o = {};
  var o1 = {};
  o.p = o1; // o 引用 o1
  o1.p = o; // o1 引用 o
  return 'circular reference';
}

foo();
```
上面函数中，我们声明了两个对象变量o和o1，这两个对象相互引用，在函数调用结束后，实际上o和o1两个变量已经离开了函数范围